{% extends "fastapp/default.html" %}

{% block title %}{{ block.super }} - Cockpit {% endblock title %}

{% block main %}

<div class="container" >
	<div class="row">
		<div class="col-md-12">
			<div><h1>Processes</h1></div>
			<table class="table">
				<tr>
					<th>Name</th>
					<th>Running</th>
					<th>Last up</th>
					<th>RSS</th>
					<th>Threads</th>
					<th>Version</th>
				</tr>
				{% for process in process_list %}
				<tr>
					<td> {{ process.name }} </td>
					<td> {{ process.is_up }} </td>
					<td> {{ process.running | date:"c"}} </td>
					<td> {{ process.rss }} </td>
					<td class="small"> {% for thread in process.threads.all %}
						{{ thread.name }} [{{ thread.health}}]</br>
						{% endfor %}
					</td>
					<td> {{ process.version }} </td>
				</tr>
				{% endfor %}
			</table>
		</div>
	</div>
	<div class="row">
		<div class="col-md-12">
			<div><h1>Executors</h1></div>
			<table class="table">
				<tr>
					<th>Username</th>
					<th>Base name</th>
					<th>Is running</th>
					<th>Marked as started</th>
					<th>PID</th>
					<th>Num instances</th>
					<th>Instances</th>
					<th>Log (Docker only)</th>
				</tr>
				{% for executor in executors %}
				<tr>
					<td> {{ executor.base.user.username }} </td>
					<td> {{ executor.base.name }} </td>
					<td> {{ executor.is_running }} </td>
					<td> {{ executor.started }} </td>
					<td> {{ executor.pid }} </td>
					<td> {{ executor.instances.count }} </td>
					<td>
						{% for instance in executor.instances.all %}
						<p> {{ instance.is_alive }} </p>
						<p> {{ instance.last_beat | date:"c"}} </p>
						{% endfor %}
					</td>
					<td><a href="{% url 'base-log' executor.base.pk %}">Log</a></td>
				</tr>
				{% endfor %}
			</table>
		</div>
	</div>
</div>
{% endblock %}
